<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seismic Wall</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Orbitron', monospace;
            background: linear-gradient(135deg, #0a0f14 0%, #1a2332 50%, #0f1419 100%);
            color: #ffffff;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Clean Space Background */
        .space-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 20% 30%, rgba(34, 197, 94, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(52, 211, 153, 0.08) 0%, transparent 40%);
        }

        /* Simple Stars */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #34d399;
            border-radius: 50%;
            opacity: 0.6;
            animation: twinkle 3s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* Header */
        .header {
            text-align: center;
            padding: 2rem 0 1rem 0;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(52, 211, 153, 0.3);
        }

        .logo-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
        }

        .logo {
            width: 70px;
            height: 70px;
            background: linear-gradient(45deg, #34d399, #10b981);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #000;
            font-weight: 900;
            animation: logoSpin 15s linear infinite;
            box-shadow: 0 0 30px rgba(52, 211, 153, 0.5);
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 50%;
        }

        @keyframes logoSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .title {
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(45deg, #ffffff, #34d399, #10b981);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .subtitle {
            font-size: 1rem;
            color: #34d399;
            margin-top: 0.5rem;
            opacity: 0.8;
        }

        /* Connection Status */
        .status {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 0.5rem 1rem;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #34d399;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            font-size: 0.8rem;
            z-index: 1000;
        }

        .status-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        .connected { background: #34d399; }
        .disconnected { background: #ef4444; }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Controls */
        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .control-btn {
            width: 45px;
            height: 45px;
            background: rgba(52, 211, 153, 0.2);
            border: 1px solid #34d399;
            border-radius: 50%;
            color: #34d399;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            background: rgba(52, 211, 153, 0.4);
            transform: scale(1.1);
        }

        /* Main Container */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
        }

        /* Wall Frame */
        .wall-frame {
            position: relative;
            width: 100%;
            min-height: 70vh;
            background: rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(52, 211, 153, 0.4);
            border-radius: 20px;
            backdrop-filter: blur(15px);
            padding: 2rem;
            overflow: visible;
        }

        /* Profile Grid */
        .profile-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1.5rem;
            position: relative;
        }

        /* Center Profile (Lyron) */
        .center-profile {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
            width: 200px;
            height: 240px;
            background: rgba(52, 211, 153, 0.15);
            border: 3px solid rgba(52, 211, 153, 0.8);
            border-radius: 20px;
            padding: 1.5rem;
            backdrop-filter: blur(20px);
            box-shadow: 0 0 50px rgba(52, 211, 153, 0.4);
            animation: centerFloat 8s ease-in-out infinite;
        }

        @keyframes centerFloat {
            0%, 100% { 
                transform: translate(-50%, -50%) scale(1);
            }
            50% { 
                transform: translate(-50%, -50%) scale(1.05);
            }
        }

        /* Floating Profiles */
        .floating-profile {
            width: 180px;
            height: 220px;
            background: rgba(52, 211, 153, 0.08);
            border: 2px solid rgba(52, 211, 153, 0.3);
            border-radius: 15px;
            padding: 1.2rem;
            backdrop-filter: blur(15px);
            transition: all 0.4s ease;
            cursor: pointer;
            animation: simpleFloat 6s ease-in-out infinite;
            position: relative;
        }

        .floating-profile:nth-child(odd) {
            animation-delay: 0s;
        }

        .floating-profile:nth-child(even) {
            animation-delay: 3s;
        }

        @keyframes simpleFloat {
            0%, 100% { 
                transform: translateY(0);
            }
            50% { 
                transform: translateY(-15px);
            }
        }

        .floating-profile:hover {
            transform: translateY(-10px) scale(1.05);
            border-color: #34d399;
            box-shadow: 0 10px 30px rgba(52, 211, 153, 0.3);
        }

        /* Profile Avatar */
        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #34d399, #10b981);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            color: #000;
            margin: 0 auto 1rem auto;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(52, 211, 153, 0.4);
        }

        .center-profile .profile-avatar {
            width: 100px;
            height: 100px;
            font-size: 1.5rem;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        /* Profile Info */
        .profile-handle {
            font-size: 1rem;
            font-weight: bold;
            color: #34d399;
            text-align: center;
            margin-bottom: 0.75rem;
            word-break: break-word;
        }

        .center-profile .profile-handle {
            font-size: 1.2rem;
            color: #ffffff;
            text-shadow: 0 0 10px rgba(52, 211, 153, 0.8);
        }

        .profile-stats {
            font-size: 0.8rem;
            text-align: center;
            opacity: 0.9;
            line-height: 1.6;
        }

        .stat-line {
            margin-bottom: 0.4rem;
            padding: 0.25rem 0.5rem;
            background: rgba(52, 211, 153, 0.1);
            border-radius: 8px;
            backdrop-filter: blur(5px);
        }

        /* Blockchain Terms */
        .blockchain-term {
            color: #10b981;
            font-weight: bold;
        }

        /* Submit Form */
        .submit-section {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
        }

        .submit-form {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(0, 0, 0, 0.7);
            padding: 1rem 2rem;
            border-radius: 25px;
            border: 2px solid rgba(52, 211, 153, 0.4);
            backdrop-filter: blur(15px);
        }

        .submit-input {
            padding: 0.75rem 1.5rem;
            background: rgba(52, 211, 153, 0.1);
            border: 2px solid rgba(52, 211, 153, 0.3);
            border-radius: 20px;
            color: #ffffff;
            font-family: 'Orbitron', monospace;
            font-size: 1rem;
            min-width: 200px;
            backdrop-filter: blur(10px);
        }

        .submit-input::placeholder {
            color: rgba(52, 211, 153, 0.6);
        }

        .submit-input:focus {
            outline: none;
            border-color: #34d399;
            box-shadow: 0 0 20px rgba(52, 211, 153, 0.3);
        }

        .submit-btn {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(45deg, #34d399, #10b981);
            border: none;
            border-radius: 20px;
            color: #000;
            font-family: 'Orbitron', monospace;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .submit-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(52, 211, 153, 0.4);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            opacity: 0.7;
        }

        .empty-state h3 {
            font-size: 1.8rem;
            color: #34d399;
            margin-bottom: 1rem;
        }

        .empty-state p {
            font-size: 1rem;
            opacity: 0.8;
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(52, 211, 153, 0.3);
            border-radius: 50%;
            border-top-color: #34d399;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .title {
                font-size: 2rem;
            }

            .main-container {
                padding: 1rem;
            }

            .wall-frame {
                min-height: 60vh;
                padding: 1rem;
            }

            .center-profile {
                width: 160px;
                height: 200px;
                padding: 1rem;
            }

            .floating-profile {
                width: 140px;
                height: 180px;
                padding: 1rem;
            }

            .profile-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 1rem;
            }

            .submit-form {
                flex-direction: column;
                gap: 0.75rem;
                padding: 1rem 1.5rem;
            }

            .submit-input {
                min-width: 180px;
            }
        }
    </style>
</head>
<body>
    <!-- Clean Space Background -->
    <div class="space-bg"></div>
    
    <!-- Simple Stars -->
    <div class="stars" id="stars"></div>

    <!-- Audio Element -->
    <audio id="backgroundMusic" loop>
        <source src="./seismic-music.mp3" type="audio/mpeg">
        <source src="./interstellar.mp3" type="audio/mpeg">
    </audio>

    <!-- Connection Status -->
    <div class="status">
        <span class="status-dot disconnected" id="statusDot"></span>
        <span id="statusText">💎 Demo Mode</span>
    </div>

    <!-- Controls -->
    <div class="controls">
        <button class="control-btn" onclick="refreshMembers()" title="Refresh">
            🔄
        </button>
        <button class="control-btn" onclick="toggleMusic()" id="musicBtn" title="Music">
            🎵
        </button>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="logo-title">
            <div class="logo">
                <img src="./seismic-logo.png" alt="S" onerror="this.innerHTML='S'">
            </div>
            <div>
                <h1 class="title">SEISMIC WALL</h1>
                <p class="subtitle">Encrypted Blockchain Community</p>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Wall Frame -->
        <div class="wall-frame">
            <div class="profile-grid" id="profileGrid">
                <div class="empty-state" id="emptyState">
                    <h3>Seismic Node Network</h3>
                    <p>Add members to build the <span class="blockchain-term">decentralized community</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Submit Form -->
    <div class="submit-section">
        <form class="submit-form" onsubmit="addMember(event)">
            <input 
                type="text" 
                class="submit-input" 
                placeholder="@handle" 
                id="usernameInput"
                required
            >
            <button type="submit" class="submit-btn">
                <span id="submitButtonText">Deploy</span>
                <span id="submitButtonLoading" class="loading" style="display: none;"></span>
            </button>
        </form>
    </div>

    <script>
        // Global variables
        let members = [];
        let isConnected = false;
        let music = document.getElementById('backgroundMusic');
        let isPlaying = false;

        // API Configuration
        const API_BASE = 'https://seismicwall.duckdns.org/api';

        // Blockchain/Crypto terms for stats
        const blockchainTerms = [
            'Node Validator', 'Block Miner', 'DeFi Pioneer', 'NFT Creator', 
            'Crypto Trader', 'Blockchain Dev', 'DAO Member', 'Hodler',
            'Smart Contract', 'Yield Farmer', 'Liquidity Provider', 'Token Holder',
            'Consensus Builder', 'Chain Explorer', 'Degen Trader', 'Alpha Hunter'
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            createSimpleStars();
            checkConnection();
            fetchMembers();
            setupKeyboardShortcuts();
            
            // Light music
            setTimeout(() => {
                music.volume = 0.2;
            }, 1000);
        });

        // Create simple star field
        function createSimpleStars() {
            const container = document.getElementById('stars');
            const starCount = 80; // Much less for performance
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                container.appendChild(star);
            }
        }

        // Check backend connection
        async function checkConnection() {
            try {
                const response = await fetch(`${API_BASE}/members`);
                isConnected = response.ok;
            } catch (error) {
                isConnected = false;
            }
            
            updateConnectionStatus();
        }

        function updateConnectionStatus() {
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');
            
            if (isConnected) {
                statusDot.className = 'status-dot connected';
                statusText.textContent = '🟢 Network Active';
            } else {
                statusDot.className = 'status-dot disconnected';
                statusText.textContent = '💎 Demo Mode';
            }
        }

        // Fetch members from API
        async function fetchMembers() {
            try {
                if (!isConnected) {
                    members = [];
                    renderMembers();
                    return;
                }
                
                const response = await fetch(`${API_BASE}/members`);
                if (!response.ok) throw new Error('Failed to fetch');
                
                members = await response.json();
                renderMembers();
            } catch (error) {
                console.error('Error fetching members:', error);
                members = [];
                renderMembers();
            }
        }

        // Render members with Lyron in center
        function renderMembers() {
            const container = document.getElementById('profileGrid');
            const emptyState = document.getElementById('emptyState');
            
            // Clear existing profiles
            container.innerHTML = '';
            
            if (members.length === 0) {
                container.appendChild(emptyState);
                return;
            }

            // Sort members - Lyron first for center position
            const sortedMembers = [...members].sort((a, b) => {
                if (a.username.toLowerCase().includes('lyronctk') || a.username.toLowerCase().includes('lyron')) return -1;
                if (b.username.toLowerCase().includes('lyronctk') || b.username.toLowerCase().includes('lyron')) return 1;
                return 0;
            });

            let centerProfileCreated = false;

            sortedMembers.forEach((member, index) => {
                const profile = document.createElement('div');
                
                // Check if this should be the center profile (Lyron)
                const isLyron = member.username.toLowerCase().includes('lyronctk') || member.username.toLowerCase().includes('lyron');
                
                if (isLyron && !centerProfileCreated) {
                    // Create center profile for Lyron
                    profile.className = 'center-profile';
                    centerProfileCreated = true;
                } else {
                    // Create floating profile for others
                    profile.className = 'floating-profile';
                }
                
                // Get random blockchain term
                const randomTerm = blockchainTerms[Math.floor(Math.random() * blockchainTerms.length)];
                
                profile.innerHTML = `
                    <div class="profile-avatar">
                        ${member.profileImage ? 
                            `<img src="${member.profileImage}" alt="${member.displayName}" onerror="this.parentElement.innerHTML='${getInitials(member.displayName)}'">` :
                            getInitials(member.displayName)
                        }
                    </div>
                    <div class="profile-handle">${member.username}</div>
                    <div class="profile-stats">
                        <div class="stat-line">🔗 ${formatNumber(member.followers || 0)} Nodes</div>
                        <div class="stat-line">${member.verified ? '✅ Verified' : '⭕ Pending'}</div>
                        <div class="stat-line">🎯 <span class="blockchain-term">${randomTerm}</span></div>
                        <div class="stat-line">⏰ ${timeAgo(member.createdAt)} ago</div>
                    </div>
                `;
                
                container.appendChild(profile);
            });
        }

        // Add new member
        async function addMember(event) {
            event.preventDefault();
            
            const input = document.getElementById('usernameInput');
            const username = input.value.trim();
            
            if (!username) return;
            
            // Show loading state
            const buttonText = document.getElementById('submitButtonText');
            const buttonLoading = document.getElementById('submitButtonLoading');
            buttonText.style.display = 'none';
            buttonLoading.style.display = 'inline-block';
            
            try {
                if (!isConnected) {
                    throw new Error('Network disconnected - Check blockchain connection');
                }
                
                const response = await fetch(`${API_BASE}/members`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username })
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Failed to deploy to network');
                }
                
                // Clear input and refresh
                input.value = '';
                await fetchMembers();
                
                // Show success
                showSuccess('Node successfully deployed to network!');
                
            } catch (error) {
                console.error('Error adding member:', error);
                showError(error.message);
            } finally {
                // Reset button state
                buttonText.style.display = 'inline-block';
                buttonLoading.style.display = 'none';
            }
        }

        // Show success message
        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.innerHTML = `✅ ${message}`;
            successDiv.style.cssText = `
                position: fixed;
                top: 30%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(52, 211, 153, 0.9);
                color: #000;
                padding: 1rem 2rem;
                border-radius: 25px;
                font-weight: bold;
                z-index: 10000;
                animation: fadeInOut 3s ease-out forwards;
            `;
            document.body.appendChild(successDiv);
            setTimeout(() => successDiv.remove(), 3000);
        }

        // Show error message
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.innerHTML = `⚠️ ${message}`;
            errorDiv.style.cssText = `
                position: fixed;
                top: 30%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(239, 68, 68, 0.9);
                color: #fff;
                padding: 1rem 2rem;
                border-radius: 25px;
                font-weight: bold;
                z-index: 10000;
                animation: fadeInOut 3s ease-out forwards;
            `;
            document.body.appendChild(errorDiv);
            setTimeout(() => errorDiv.remove(), 3000);
        }

        // Refresh members
        async function refreshMembers() {
            await checkConnection();
            await fetchMembers();
        }

        // Music controls
        function toggleMusic() {
            const btn = document.getElementById('musicBtn');
            
            if (isPlaying) {
                music.pause();
                btn.textContent = '🎵';
                isPlaying = false;
            } else {
                music.play().catch(e => console.log('Music play failed:', e));
                btn.textContent = '🔊';
                isPlaying = true;
            }
        }

        // Keyboard shortcuts
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', function(e) {
                if (e.key === ' ' && e.target.tagName !== 'INPUT') {
                    e.preventDefault();
                    toggleMusic();
                } else if (e.key === 'r' && !e.ctrlKey && e.target.tagName !== 'INPUT') {
                    e.preventDefault();
                    refreshMembers();
                }
            });
        }

        // Utility functions
        function getInitials(name) {
            return name.split(' ').map(word => word[0]).join('').toUpperCase().slice(0, 2);
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        function timeAgo(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) return 'now';
            if (diffInSeconds < 3600) return Math.floor(diffInSeconds / 60) + 'm';
            if (diffInSeconds < 86400) return Math.floor(diffInSeconds / 3600) + 'h';
            return Math.floor(diffInSeconds / 86400) + 'd';
        }

        // Add CSS animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeInOut {
                0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
                20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
                80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                100% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
